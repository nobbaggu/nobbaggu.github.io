I"G<p><a href="https://github.com/swnomad/rssfeeder" target="_blank">SQLite3 ì‚¬ìš©ë²•</a></p>

<p>ì´ í¬ìŠ¤íŒ…ì€ ìœ„ ë§í¬ì—ì„œ ì„¤ëª…í•œ SQLite ë°ì´í„°ë² ì´ìŠ¤ì˜ ê¸°ë³¸ ì‚¬ìš©ë²•ì„ ì•Œê³ ë‚˜ì„œ ë”ìš± í¸ë¦¬í•˜ê²Œ ë°ì´í„°ë² ì´ìŠ¤ ì—´ê¸° ë° ìˆ˜ì •ì„ ìœ„í•œ SQLiteOpenHelper í´ë˜ìŠ¤ì˜ ì‚¬ìš© ëª©ì ê³¼ ë°©ë²•ì— ëŒ€í•œ ê¸€ì´ë‹¤.</p>

<p><br /></p>
<h2 id="sqliteopenhelper-í´ë˜ìŠ¤ë¥¼-ì‚¬ìš©í•˜ëŠ”-ì´ìœ ">SQLiteOpenHelper í´ë˜ìŠ¤ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ </h2>
<hr />

<p>êµ¬ê¸€ í”Œë ˆì´ìŠ¤í† ì–´ì— ì˜¬ë¦° ì•±ì´ SQLiteë¥¼ ì‚¬ìš©í•  ê²½ìš° DBì˜ êµ¬ì¡°ê°€ ë³€ê²½ë  ê²½ìš°ê°€ ìˆë‹¤. ì˜ˆë¥¼ë“¤ë©´ ì‚¬ëŒë“¤ì˜ ì •ë³´ë¥¼ ì €ì¥í•˜ê¸°ìœ„í•´ â€˜ì´ë¦„â€™, â€˜ë‚˜ì´â€™ columnë§Œ ì‚¬ìš©í–ˆì—ˆëŠ”ë° ì´í›„ì— â€˜íœ´ëŒ€í° ë²ˆí˜¸â€™ columnì„ ì¶”ê°€í•´ì•¼ í•˜ëŠ” ê²½ìš°ì´ë‹¤. ì´ ë•Œ ì•±ì„ ë²„ì „ ì—…ê·¸ë ˆì´ë“œí•˜ë©´ì„œ ìƒˆë¡œ ë°°í¬í•  ë•Œ, ê¸°ì¡´ì˜ í…Œì´ë¸”ì„ dropí•˜ê³  ìƒˆë¡œ ë§Œë“¤ë„ë¡í•˜ë©´ ê¸°ì¡´ ì‚¬ìš©ìì˜ ë°ì´í„°ê°€ ëª¨ë‘ ë‚ ì•„ê°€ë²„ë¦¬ëŠ” ë¶ˆìƒì‚¬ê°€ ìƒê²¨ë²„ë¦°ë‹¤. ë”°ë¼ì„œ ì‹ ê·œ ì‚¬ìš©ìì˜ ê²½ìš°ëŠ” ë‹¨ìˆœíˆ ìƒˆë¡œìš´ êµ¬ì¡°ì˜ í…Œì´ë¸”ì„ ìƒì„±í•˜ë©´ ë˜ì§€ë§Œ, ê¸°ì¡´ ì‚¬ìš©ìì˜ ê²½ìš° ê¸°ì¡´ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë©´ì„œ ì—…ê·¸ë ˆì´ë“œ í•´ì£¼ì–´ì•¼í•œë‹¤.</p>

<p>ì´ëŸ¬í•œ ê²½ìš° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ê²ƒì´ SQLiteOpenHelperì´ë‹¤.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="nf">SQLiteOpenHelper</span><span class="o">(</span><span class="nc">Context</span> <span class="n">context</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">SQLiteDatabase</span><span class="o">.</span><span class="na">CursorFactory</span> <span class="n">factory</span><span class="o">,</span> <span class="kt">int</span> <span class="n">version</span><span class="o">)</span>
</code></pre></div></div>

<p>SQLiteOpenHelper ê°ì²´ë¥¼ ë§Œë“¤ ë•Œ ìƒì„±ìì˜ íŒŒë¼ë¯¸í„°ë¡œëŠ” 4ê°œì˜ ë³€ìˆ˜ê°€ ì „ë‹¬ë˜ëŠ”ë°, nameì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ì´ë¦„ì´ë‹¤. ê·¸ë¦¬ê³  ë§ˆì§€ë§‰ íŒŒë¼ë¯¸í„°ì¸ ì •ìˆ˜ versionìœ¼ë¡œ ì „ë‹¬ë˜ëŠ” ë²„ì „ì •ë³´ë¥¼ ê¸°ì¡´ì˜ ë²„ì „ì •ë³´ì™€ ë‹¤ë¥´ê²Œ ì§€ì •í•˜ì—¬ DBì˜ êµ¬ì¡°ë¥¼ ì—…ê·¸ë ˆì´ë“œ í•  ìˆ˜ ìˆë‹¤.</p>

<p>SQLiteOpenHelper í´ë˜ìŠ¤ì˜ ì£¼ ì‚¬ìš© ëª©ì ì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ ìƒì„± ë° ì—…ê·¸ë ˆì´ë“œê°€ í•„ìš”í•  ì‹œì— ìë™ìœ¼ë¡œ ì½œë°± ë©”ì†Œë“œê°€ í˜¸ì¶œëœë‹¤ëŠ” ì ì—ì„œ ì˜¨ë‹¤. ì´ ì½œë°± ë©”ì†Œë“œë¥¼ ì¬ì •ì˜í•¨ìœ¼ë¡œì„œ DBì˜ ìƒì„±, ì—…ê·¸ë ˆì´ë“œ ë“±ì˜ ìƒíƒœì— ë§ê²Œ ì•Œë§ì€ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤.</p>

<p><br /></p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">SQLiteDatabase</span> <span class="n">db</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">onOpen</span><span class="o">(</span><span class="nc">SQLiteDatabase</span> <span class="n">db</span><span class="o">)</span>
<span class="kd">public</span> <span class="kd">abstract</span> <span class="kt">void</span> <span class="nf">opUpgrade</span><span class="o">(</span><span class="nc">SQLiteDatabase</span> <span class="n">db</span><span class="o">,</span> <span class="kt">int</span> <span class="n">oldVersion</span><span class="o">,</span> <span class="kt">int</span> <span class="n">newVersion</span><span class="o">)</span>
</code></pre></div></div>

<p><br /></p>

<p>ìƒì„±ìì˜ íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ëœ DBì˜ ì´ë¦„ì´ ì—†ë‹¤ë©´ <code class="highlighter-rouge">onCreate()</code> ë©”ì†Œë“œê°€ í˜¸ì¶œë˜ê³  ì´ë¯¸ ì‚¬ìš©ì¤‘ì¸ DBë¼ë©´ <code class="highlighter-rouge">onUpgrade()</code> ë©”ì†Œë“œê°€ í˜¸ì¶œëœë‹¤.</p>

<p><br /></p>

<div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="utf-8"?&gt;</span>
<span class="nt">&lt;LinearLayout</span>
    <span class="na">xmlns:android=</span><span class="s">"http://schemas.android.com/apk/res/android"</span>
    <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
    <span class="na">android:layout_height=</span><span class="s">"match_parent"</span>
    <span class="na">android:orientation=</span><span class="s">"vertical"</span><span class="nt">&gt;</span>

    <span class="nt">&lt;LinearLayout</span>
        <span class="na">android:layout_width=</span><span class="s">"match_parent"</span>
        <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
        <span class="na">android:orientation=</span><span class="s">"horizontal"</span><span class="nt">&gt;</span>

        <span class="nt">&lt;EditText</span>
            <span class="na">android:id=</span><span class="s">"@+id/dbNameInput"</span>
            <span class="na">android:layout_width=</span><span class="s">"0dp"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:hint=</span><span class="s">"ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„"</span>
            <span class="na">android:textSize=</span><span class="s">"16dp"</span>
            <span class="na">android:layout_weight=</span><span class="s">"3"</span>
            <span class="na">android:layout_margin=</span><span class="s">"5dp"</span><span class="nt">/&gt;</span>

        <span class="nt">&lt;Button</span>
            <span class="na">android:id=</span><span class="s">"@+id/createDbBtn"</span>
            <span class="na">android:layout_width=</span><span class="s">"120dp"</span>
            <span class="na">android:layout_height=</span><span class="s">"wrap_content"</span>
            <span class="na">android:textSize=</span><span class="s">"16dp"</span>
            <span class="na">android:text=</span><span class="s">"DB ìƒì„±"</span>
            <span class="na">android:layout_margin=</span><span class="s">"5dp"</span><span class="nt">/&gt;</span>

    <span class="nt">&lt;/LinearLayout&gt;</span>

<span class="nt">&lt;/LinearLayout&gt;</span>
</code></pre></div></div>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MainActivity</span> <span class="kd">extends</span> <span class="nc">AppCompatActivity</span> <span class="o">{</span>

    <span class="nc">SQLiteDatabase</span> <span class="n">database</span><span class="o">;</span>
    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">DB_VERSION</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="c1">// ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „</span>

    <span class="kd">private</span> <span class="nc">DatabaseOpenHelper</span> <span class="n">helper</span><span class="o">;</span>

    <span class="nc">EditText</span> <span class="n">dbNameInput</span><span class="o">;</span>
    <span class="nc">EditText</span> <span class="n">tableNameInput</span><span class="o">;</span>

    <span class="nc">String</span> <span class="n">dbName</span><span class="o">;</span>
    <span class="nc">String</span> <span class="n">tableName</span><span class="o">;</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">Bundle</span> <span class="n">savedInstanceState</span><span class="o">)</span> <span class="o">{</span>
        <span class="kd">super</span><span class="o">.</span><span class="na">onCreate</span><span class="o">(</span><span class="n">savedInstanceState</span><span class="o">);</span>
        <span class="n">setContentView</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">layout</span><span class="o">.</span><span class="na">activity_main</span><span class="o">);</span>

        <span class="cm">/* ********** XMLì— ì •ì˜ëœ UIê°ì²´ ì°¸ì¡° ************ */</span>
        <span class="n">dbNameInput</span> <span class="o">=</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">dbNameInput</span><span class="o">);</span>
        <span class="nc">Button</span> <span class="n">createDbBtn</span> <span class="o">=</span> <span class="n">findViewById</span><span class="o">(</span><span class="no">R</span><span class="o">.</span><span class="na">id</span><span class="o">.</span><span class="na">createDbBtn</span><span class="o">);</span>
        <span class="cm">/* ************************************************* */</span>

        <span class="cm">/* ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸ */</span>
        <span class="n">createDbBtn</span><span class="o">.</span><span class="na">setOnClickListener</span><span class="o">(</span><span class="k">new</span> <span class="nc">View</span><span class="o">.</span><span class="na">OnClickListener</span><span class="o">()</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onClick</span><span class="o">(</span><span class="nc">View</span> <span class="n">v</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">try</span><span class="o">{</span>
                    <span class="cm">/* ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± */</span>
                    <span class="n">dbName</span> <span class="o">=</span> <span class="n">dbNameInput</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                    <span class="n">helper</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DatabaseOpenHelper</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="n">dbName</span><span class="o">,</span> <span class="kc">null</span><span class="o">,</span> <span class="no">DB_VERSION</span><span class="o">);</span>
					
					<span class="c1">// helper ê°ì²´ë¥¼ í†µí•´ db ë¶ˆëŸ¬ì˜¤ê¸°</span>
                    <span class="cm">/* 1. dbNameê³¼ ê°™ì€ ì´ë¦„ì˜ DBê°€ ì—†ìœ¼ë©´ helper í´ë˜ìŠ¤ì˜ onCreate() í˜¸ì¶œ
                     * 2. dbNameê³¼ ê°™ì€ ì´ë¦„ì˜ DBê°€ ìˆìœ¼ë©´ version ì „ë‹¬ë˜ë©´ì„œ helper í´ë˜ìŠ¤ì˜ onUprgrade() í˜¸ì¶œ */</span>
                    <span class="n">database</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="na">getWritableDatabase</span><span class="o">();</span>

                <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">});</span>

    <span class="o">}</span>

    <span class="kd">class</span> <span class="nc">DatabaseOpenHelper</span> <span class="kd">extends</span> <span class="nc">SQLiteOpenHelper</span> <span class="o">{</span>

        <span class="kd">public</span> <span class="nf">DatabaseOpenHelper</span><span class="o">(</span><span class="nc">Context</span> <span class="n">context</span><span class="o">,</span> <span class="nc">String</span> <span class="n">name</span><span class="o">,</span> <span class="nc">SQLiteDatabase</span><span class="o">.</span><span class="na">CursorFactory</span> <span class="n">factory</span><span class="o">,</span> <span class="kt">int</span> <span class="n">version</span><span class="o">)</span> <span class="o">{</span>
            <span class="kd">super</span><span class="o">(</span><span class="n">context</span><span class="o">,</span> <span class="n">name</span><span class="o">,</span> <span class="n">factory</span><span class="o">,</span> <span class="n">version</span><span class="o">);</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onCreate</span><span class="o">(</span><span class="nc">SQLiteDatabase</span> <span class="n">db</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">"Helperí´ë˜ìŠ¤ onCreate() í˜¸ì¶œë¨"</span><span class="o">,</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>

            <span class="cm">/* DBê°€ ì²˜ìŒ ë§Œë“¤ì–´ì¡Œìœ¼ë¯€ë¡œ í…Œì´ë¸” ìƒì„± */</span>
            <span class="k">if</span><span class="o">(</span><span class="n">db</span><span class="o">!=</span><span class="kc">null</span><span class="o">)</span>
            <span class="o">{</span>
                <span class="k">try</span><span class="o">{</span>
                    <span class="n">tableName</span> <span class="o">=</span> <span class="n">tableNameInput</span><span class="o">.</span><span class="na">getText</span><span class="o">().</span><span class="na">toString</span><span class="o">();</span>
                    <span class="cm">/* í…Œì´ë¸” ìƒì„±ì„ ìœ„í•œ SQLë¬¸ ì‘ì„± */</span>
                    <span class="nc">String</span> <span class="n">sql</span> <span class="o">=</span> <span class="s">"create table if not exists "</span> <span class="o">+</span> <span class="n">tableName</span> <span class="o">+</span> <span class="s">"(_id integer PRIMARY KEY autoincrement, name text, age integer);"</span><span class="o">;</span>
                    <span class="n">db</span><span class="o">.</span><span class="na">execSQL</span><span class="o">(</span><span class="n">sql</span><span class="o">);</span> <span class="c1">//sqlë¬¸ ì‹¤í–‰</span>
                <span class="o">}</span><span class="k">catch</span><span class="o">(</span><span class="nc">Exception</span> <span class="n">e</span><span class="o">){</span>
                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
                <span class="o">}</span>

            <span class="o">}</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onUpgrade</span><span class="o">(</span><span class="nc">SQLiteDatabase</span> <span class="n">db</span><span class="o">,</span> <span class="kt">int</span> <span class="n">oldVersion</span><span class="o">,</span> <span class="kt">int</span> <span class="n">newVersion</span><span class="o">)</span> <span class="o">{</span>
            <span class="nc">Toast</span><span class="o">.</span><span class="na">makeText</span><span class="o">(</span><span class="nc">MainActivity</span><span class="o">.</span><span class="na">this</span><span class="o">,</span> <span class="s">"Helperí´ë˜ìŠ¤ onUpgrade() í˜¸ì¶œë¨: "</span>
                    <span class="o">+</span> <span class="n">oldVersion</span> <span class="o">+</span><span class="s">" -&gt; "</span> <span class="o">+</span> <span class="n">newVersion</span><span class="o">,</span> <span class="nc">Toast</span><span class="o">.</span><span class="na">LENGTH_SHORT</span><span class="o">).</span><span class="na">show</span><span class="o">();</span>
        <span class="o">}</span>

        <span class="nd">@Override</span>
        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">onOpen</span><span class="o">(</span><span class="nc">SQLiteDatabase</span> <span class="n">db</span><span class="o">)</span> <span class="o">{</span>
            <span class="c1">//Toast.makeText(MainActivity.this, "Helperí´ë˜ìŠ¤ onOpen() í˜¸ì¶œë¨", Toast.LENGTH_SHORT).show();</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<p>ì½œë°± ë©”ì†Œë“œë¥¼ í™•ì¸í•˜ê¸° ìœ„í•´ í† ìŠ¤íŠ¸ ë©”ì‹œì§€ë¥¼ ë§Œë“¤ì—ˆë‹¤. ìœ„ ì•±ì„ ì‹¤í–‰í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì´ ë‚˜íƒ€ë‚œë‹¤.</p>

<p><img src="/images/android/54/1.jpg" alt="1" width="30%" height="30%" /></p>

<p><br /></p>

<p>ìœ„ ì½”ë“œì—ì„œ ë²„ì „ì„ ì•„ë˜ì™€ ê°™ì´ 2ë¡œ ë°”ê¾¸ê³  ë‹¤ì‹œ ì‹¤í–‰í•´ë³´ì.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="kt">int</span> <span class="no">DB_VERSION</span> <span class="o">=</span> <span class="mi">2</span><span class="o">;</span> <span class="c1">// ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „</span>
</code></pre></div></div>

<p>ê·¸ëŸ¼ ì•„ë˜ì™€ ê°™ì€ í™”ë©´ì„ ë³¼ ìˆ˜ ìˆë‹¤.</p>

<p><img src="/images/android/54/2.jpg" alt="2" width="30%" height="30%" /></p>

<p><br /></p>

<p>ì‚¬ì‹¤ ìœ„ 2ê°€ì§€ ì„œë¡œ ë‹¤ë¥¸ ìƒíƒœ ë©”ì†Œë“œ ì´í›„ì— ê³§ë°”ë¡œ onOpen() ë©”ì†Œë“œê°€ í˜¸ì¶œëœë‹¤. ì—¬ê¸°ì—ì„œëŠ” DB ì¡°íšŒì™€ ê°™ì´ ì‚¬ìš© ì½”ë“œë¥¼ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>

<p>ì´ë ‡ê²Œ ë²„ì „ ì •ë³´ë¥¼ ë„£ì–´ì¤Œìœ¼ë¡œì¨ ë‹¤ë¥¸ ë©”ì†Œë“œê°€ í˜¸ì¶œëœë‹¤. ìƒí™©ì— ë”°ë¼ ê° ë©”ì†Œë“œë¥¼ ì¬ì •ì˜ í•¨ìœ¼ë¡œì¨ ì‹ ê·œ ì‚¬ìš©ìì™€ ê¸°ì¡´ ì‚¬ìš©ì ì‚¬ì´ì˜ ìœ ì—°í•œ ì½”ë“œ ì²˜ë¦¬ê°€ ê°€ëŠ¥í•˜ë‹¤. ì´ ë¶€ë¶„ì´ SQLiteOpenHelperë¥¼ ì‚¬ìš©í•˜ëŠ” ì£¼ ëª©ì ì´ë‹¤. ë‚˜ë¨¸ì§€ ë°ì´í„° ì¡°ì‘ì— ê´€í•œ ë¶€ë¶„ì€ ì¼ë°˜ì ì¸ SQLite3 ì‚¬ìš©ë²•ê³¼ ë™ì¼í•˜ë‹¤. <code class="highlighter-rouge">execSQL()</code> ë©”ì†Œë“œë‚˜ <code class="highlighter-rouge">rawQuery()</code> ë©”ì†Œë“œë¥¼ í†µí•´ ë°ì´í„° ì¶”ê°€/ì‚­ì œ ë° ì¡°íšŒë¥¼ í•  ìˆ˜ ìˆë‹¤.</p>
:ET